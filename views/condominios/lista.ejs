<div class="d-flex justify-content-between align-items-start flex-wrap gap-2 mb-3">
<div>
<h4 class="page-title mb-1">
<i class="bi bi-buildings text-primary me-2"></i>
Condomínios
</h4>
<p class="text-muted mb-0">
Gerencie condomínios e seus dados principais.
</p>
</div>

<button
type="button"
class="btn btn-primary"
hx-get="/condominios/novo?partial=1"
hx-target="#condominioModalBody"
hx-swap="innerHTML"

<i class="bi bi-plus-circle me-1"></i>
Novo condomínio

</button>
</div>

<div class="card">
<div class="card-body">
<% if (!condominios || condominios.length === 0) { %>
<p class="text-muted mb-0">Nenhum condomínio cadastrado ainda.</p>
<% } else { %>
<div class="table-responsive">
<table class="table align-middle">
<thead>
<tr>
<th>ID</th>
<th>Nome</th>
<th>Código Interno</th>
<th>Cidade/UF</th>
<th>Status</th>
<th class="text-end" style="width: 240px;">Ações</th>
</tr>
</thead>
<tbody id="tabelaCondominios">
<% condominios.forEach(c => { %>
<%- include('_linha', { c: c }) %>
<% }) %>
</tbody>
</table>
</div>
<% } %>
</div>
</div>

<script src="https://unpkg.com/htmx.org@1.9.12"></script>

<script>
// Abrir modal quando carregar o formulário
document.body.addEventListener('htmx:afterSwap', function (evt) {
if (evt.target && evt.target.id === 'condominioModalBody') {
const modalEl = document.getElementById('condominioModal');
const modal = bootstrap.Modal.getOrCreateInstance(modalEl);
modal.show();
}
});

// Fechar modal após salvar (form HTMX)
document.body.addEventListener('htmx:afterRequest', function(evt) {
const el = evt.detail && evt.detail.elt ? evt.detail.elt : null;
if (!el || !evt.detail.successful) return;

if (el.id === 'formCondominioHtmx') {
  const modalEl = document.getElementById('condominioModal');
  const modal = bootstrap.Modal.getInstance(modalEl);
  if (modal) modal.hide();
}

});
</script>

<div class="modal fade" id="condominioModal" tabindex="-1">
<div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Condomínio</h5>
<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
</div>
<div class="modal-body" id="condominioModalBody"></div>
</div>
</div>
</div>